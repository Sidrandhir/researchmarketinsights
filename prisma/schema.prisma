// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String?
  role      Role     @default(USER)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations
  reports     Report[]
  pressReleases PressRelease[]
  leads       Lead[]
  orders      Order[]

  @@map("users")
}

model Report {
  id          String   @id @default(cuid())
  title       String
  slug        String   @unique
  description String?
  content     Json?
  price       Decimal  @db.Decimal(10, 2)
  discount    Decimal? @db.Decimal(5, 2)
  reportCode  String   @unique
  category    Category
  subcategory String?
  imageUrl    String?
  toc         Json?
  scope       Json?
  segments    Json?
  faqs        Json?
  metaTitle   String?
  metaDescription String?
  keywords    String?
  status      Status   @default(DRAFT)
  featured    Boolean  @default(false)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Relations
  author      User     @relation(fields: [authorId], references: [id])
  authorId    String
  orders      Order[]
  samples     Sample[]

  @@map("reports")
}

model PressRelease {
  id          String   @id @default(cuid())
  title       String
  slug        String   @unique
  content     String
  excerpt     String?
  imageUrl    String?
  category    Category
  metaTitle   String?
  metaDescription String?
  keywords    String?
  status      Status   @default(DRAFT)
  featured    Boolean  @default(false)
  publishedAt DateTime?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Relations
  author      User     @relation(fields: [authorId], references: [id])
  authorId    String

  @@map("press_releases")
}

model Lead {
  id          String   @id @default(cuid())
  name        String
  email       String
  company     String?
  phone       String?
  country     String?
  message     String?
  source      String?
  status      LeadStatus @default(NEW)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Relations
  user        User?    @relation(fields: [userId], references: [id])
  userId      String?

  @@map("leads")
}

model Order {
  id          String   @id @default(cuid())
  orderNumber String   @unique
  amount      Decimal  @db.Decimal(10, 2)
  currency    String   @default("USD")
  status      OrderStatus @default(PENDING)
  paymentMethod String?
  transactionId String?
  customerEmail String
  customerName  String
  customerCompany String?
  customerPhone  String?
  customerCountry String?
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Relations
  user        User?    @relation(fields: [userId], references: [id])
  userId      String?
  report      Report   @relation(fields: [reportId], references: [id])
  reportId    String

  @@map("orders")
}

model Sample {
  id          String   @id @default(cuid())
  email       String
  name        String
  company     String?
  phone       String?
  country     String?
  message     String?
  status      SampleStatus @default(PENDING)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  // Relations
  report      Report   @relation(fields: [reportId], references: [id])
  reportId    String

  @@map("samples")
}

model StaticPage {
  id          String   @id @default(cuid())
  title       String
  slug        String   @unique
  content     String
  metaTitle   String?
  metaDescription String?
  keywords    String?
  status      Status   @default(DRAFT)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  @@map("static_pages")
}

model Setting {
  id    String @id @default(cuid())
  key   String @unique
  value String
  type  String @default("string")

  @@map("settings")
}

enum Role {
  USER
  ADMIN
  EDITOR
}

enum Category {
  AEROSPACE_DEFENSE
  AUTOMOTIVE_TRANSPORTATION
  BANKING_FINANCIAL_SERVICES_INSURANCE
  CHEMICALS_MATERIALS
  CONSUMER_GOODS
  ELECTRONICS_SEMICONDUCTOR
  ENERGY_POWER
  FOOD_BEVERAGES
  LIFE_SCIENCES
  TECHNOLOGY_MEDIA_TELECOMMUNICATIONS
}

enum Status {
  DRAFT
  PUBLISHED
  ARCHIVED
}

enum LeadStatus {
  NEW
  CONTACTED
  QUALIFIED
  CONVERTED
  LOST
}

enum OrderStatus {
  PENDING
  PAID
  COMPLETED
  CANCELLED
  REFUNDED
}

enum SampleStatus {
  PENDING
  APPROVED
  SENT
  REJECTED
} 